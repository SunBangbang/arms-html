function getRegCodeCheck(){$.ajax({type:"post",url:"ajax.php?m=getRegCodeCheck",data:{"token":token},dataType:"json",success:function(data){errorCheck(data);if(data[0][0]=="2"){$(".reg-invite").hide();$("#on-mobcaptcha").attr("src","/ajax.php?m=getCaptcha&mob");$(".on-mailverify").hide();$(".no-verify").hide();$(".on-mobverify").show()}else{if(data[0][0]=="1"){$(".reg-invite").hide();$("#on-mailcaptcha").attr("src","/ajax.php?m=getCaptcha&mail");$(".on-mailverify").show();$(".no-verify").hide();$(".on-mobverify").hide()}else{if(data[0][0]=="0"){$(".reg-invite").hide();$("#no-captcha").attr("src","/ajax.php?m=getCaptcha&no");$(".on-mailverify").hide();$(".no-verify").show();$(".on-mobverify").hide()}else{$(".reg-invite").show();$("#reg-invite-code").attr("src","/ajax.php?m=getCaptcha&yqm");$(".on-mailverify").hide();$(".no-verify").hide();$(".on-mobverify").hide()}}}},error:function(data){debugLog(data)}});return false}function mailSendCheck(){debugLog("load_reg run-->");if(loggedin){Materialize.toast("您已登陆！",4000,"rounded");window.location.href="account.html";return false}$.ajax({type:"post",url:"ajax.php?m=mailSendCheck",data:{"token":token},dataType:"json",success:function(data){debugLog(data);errorCheck(data);if(data[0][0]=="2"){$("#verify_regmailone").hide();$("#verify_regmailtwo").show()}else{$("#verify_regmailone").show();$("#verify_regmailtwo").hide()}},error:function(data){debugLog(data)}});return false}function mobSendCheck(){debugLog("load_reg run-->");if(loggedin){Materialize.toast("您已登陆！",4000,"rounded");window.location.href="account.html";return false}$.ajax({type:"post",url:"ajax.php?m=mobSendCheck",data:{"token":token},dataType:"json",success:function(data){debugLog(data);errorCheck(data);if(data[0][0]=="2"){$("#verify_regmobone").hide();$("#verify_regmobtwo").show()}else{$("#verify_regmobone").show();$("#verify_regmobtwo").hide()}},error:function(data){debugLog(data)}});return false}function regVerifyCheck(){if(loggedin){Materialize.toast("您已登陆！",4000,"rounded");window.location.href="account.html";return false}debugLog("verify run"+token);$.ajax({type:"post",url:"ajax.php?m=getEmailVerify",data:{"token":token},dataType:"json",success:function(data){errorCheck(data);if(data[1][0]=="1"){$.ajax({type:"post",url:"ajax.php?m=regInvite",data:{"token":token},dataType:"json",success:function(data){errorCheck(data);if(data[1][0]=="1"){getRegCodeCheck()}else{$(".on-mailverify").show();$(".reg-invite").hide();$("#on-mailcaptcha").attr("src","/ajax.php?m=getCaptcha&mail");$(".no-verify").hide();$(".on-mobverify").hide()}},error:function(data){ebugLog(data)}})}else{if(data[1][0]=="2"){$.ajax({type:"post",url:"ajax.php?m=regInvite",data:{"token":token},dataType:"json",success:function(data){errorCheck(data);if(data[1][0]=="1"){getRegCodeCheck()}else{$(".on-mailverify").hide();$(".reg-invite").hide();$("#on-mobcaptcha").attr("src","/ajax.php?m=getCaptcha&mob");$(".no-verify").hide();$(".on-mobverify").show()}},error:function(data){ebugLog(data)}})}else{$.ajax({type:"post",url:"ajax.php?m=regInvite",data:{"token":token},dataType:"json",success:function(data){errorCheck(data);if(data[1][0]=="1"){getRegCodeCheck()}else{$(".on-mailverify").hide();$(".reg-invite").hide();$("#no-captcha").attr("src","/ajax.php?m=getCaptcha&no");$(".no-verify").show();$(".on-mobverify").hide()}},error:function(data){ebugLog(data)}})}}},error:function(data){debugLog(data)}});return false}$(".no-verify").submit(function(){debugLog($("form").serializeArray());$.ajax({type:"post",url:"ajax.php?m=noVerifyRegister",data:$("form").serialize()+"&token="+token,dataType:"json",success:function(data){debugLog(data);if(errorCheck(data)){$("#no-captcha").click();return false}Materialize.toast(data[0][1],2000,"rounded",function(){window.location.href="./account.html"})},error:function(data){debugLog(data)}});return false});$(document).ready(function(){regVerifyCheck();mailSendCheck();mobSendCheck();$("#invitecode").click(function(){$.ajax({type:"post",url:"ajax.php?m=getRegCode",data:{"invitecode":$("#invite_code").val(),"captcha":$("#invite_captchas").val(),"token":token},dataType:"json",success:function(data){debugLog(data);if(errorCheck(data)){$("#reg-invite-code").click();return false}Materialize.toast(data[0][1],4000,"rounded");if(data[0][0]=="1"){getRegCodeCheck()}},error:function(data){debugLog(data)}});$("#reg-invite-code").click();return false});$("#sendmobile").click(function(){$.ajax({type:"post",url:"ajax.php?m=sendRegMobile",data:{"captcha":$("#verify_captchas").val(),"mobile":$("#verify_mobile").val(),"username":$("#verify_usernames").val(),"token":token},dataType:"json",success:function(data){debugLog(data);if(errorCheck(data)){$("#on-mobcaptcha").click();return false}Materialize.toast(data[0][1],4000,"rounded");if(data[0][0]=="1"){mobSendCheck()}},error:function(data){debugLog(data)}});$("#on-mobcaptcha").click();return false});$("#regaccounts").click(function(){if(!$('[name="verify_agree"]').prop("checked")){Materialize.toast("请同意注册协议！",4000,"rounded");return false}else{$("#regaccounts").html("提交中...");$.ajax({type:"post",url:"ajax.php?m=register",data:{"password":$("#verify_mpassword").val(),"repeat":$("#verify_mrepeat").val(),"regkey":$("#verify_mregkey").val(),"token":token},dataType:"json",success:function(data){debugLog(data);if(errorCheck(data)){$("#regaccounts").html("注册");return false}Materialize.toast(data[0][1],4000,"rounded");if(data[0][0]=="1"){setTimeout(function(){window.location.href="./account.html"},2000)}if(data[0][0]=="2"){setTimeout(function(){window.location.href="./register.html"},2000)}$("#regaccounts").html("注册")},error:function(data){debugLog(data)}});return false}});$("#sendmail").click(function(){$.ajax({type:"post",url:"ajax.php?m=sendRegMail",data:{"captcha":$("#verify_captcha").val(),"email":$("#verify_email").val(),"username":$("#verify_username").val(),"token":token},dataType:"json",success:function(data){debugLog(data);if(errorCheck(data)){$("#on-mailcaptcha").click();return false}Materialize.toast(data[0][1],4000,"rounded");if(data[0][0]=="1"){mailSendCheck()}},error:function(data){debugLog(data)}});$("#on-mailcaptcha").click();return false});$("#regaccount").click(function(){if(!$('[name="verify_agree"]').prop("checked")){Materialize.toast("请同意注册协议！",4000,"rounded");return false}else{$("#regaccount").html("提交中...");$.ajax({type:"post",url:"ajax.php?m=register",data:{"password":$("#verify_password").val(),"repeat":$("#verify_repeat").val(),"regkey":$("#verify_regkey").val(),"token":token},dataType:"json",success:function(data){debugLog(data);if(errorCheck(data)){$("#regaccount").html("注册");return false}Materialize.toast(data[0][1],4000,"rounded");if(data[0][0]=="1"){setTimeout(function(){window.location.href="./account.html"},2000)}if(data[0][0]=="2"){setTimeout(function(){window.location.href="./register.html"},2000)}$("#regaccount").html("注册")},error:function(data){debugLog(data)}});return false}})});