var quesid;function getQuestion(obj){debugLog(obj);quesid=obj.id;debugLog("click1");$.ajax({type:"POST",url:"ajax.php?m=getQuestion",data:{"id":quesid,"token":token},dataType:"json",success:function(data){console.log(data);if(errorCheck(data)){return false}debugLog(quesid);$("#ques_solve").html("Solves : "+data[1][2]);if(data[1][4]=="0"){$("#ques_score").html(data[1][3]+" PT")}else{$("#ques_score").html(data[1][3]+" PT | "+"Silver: "+data[1][4])}$("#ques_tit").html(data[1][0]);$("#ques_con").html(data[1][1]);$("#modal").modal("open")}});return false}function getQuestionSolves(){$.ajax({type:"POST",url:"ajax.php?m=getQuestionSolves",data:{"id":quesid,"token":token},dataType:"json",success:function(data){debugLog(data);if(errorCheck(data)){return false}var table=$("<table>");var thead=$("<thead>");$("<th><b>").text("No.").appendTo(thead);$("<th><b>").text("User").appendTo(thead);$("<th><b>").text("Date").appendTo(thead);thead.appendTo(table);$.each(data[1],function(num,content){var trow=$("<tr>");$("<td>").text(num+1).appendTo(trow);$("<td>").text(content[0]).appendTo(trow);$("<td>").text(getMyDate(content[1])).appendTo(trow);trow.appendTo(table)});$("#solves").html(table.html())},error:function(data){debugLog(data)}});return false}function getQuestions(){$.ajax({type:"post",url:"ajax.php?m=getQuestions",dataType:"json",data:{"token":token},success:function(data){if(errorCheck(data)){$(".questions").html('<h2 class="center">Where there is a will, there is a way.</h2>');return false}var ques="",type=-1;$.each(data[1],function(num,content){if(type!=content[1]){type=content[1];if(num){ques+="<br><br></div>"}ques+='<div style="height:auto;margin:0 auto; overflow:hidden" class="row questionsType"><br /><h3 class="header">'+quesType[content[1]]+"</h3><hr>"}if(content[4]==="1"){ques+='<button style="border-radius: 12px;"class="green lighten-2 btn-large col s6 m4 l3" id="'+content[0]+'" onclick="getQuestion(this)"><div style="min-height:30%;font-size: 14px">'+content[2]+'</div><span style="font-size: 12px;">'+content[3]+" PT</span></button>"}else{if(content[4]==="lock"){ques+='<button style="border-radius: 12px;" class="grey btn-large col s6 m4 l3" id="'+content[0]+'" onclick="getQuestion(this)"><div style="min-height:30%;font-size: 14px">'+content[2]+'</div><span style="font-size: 12px;">'+content[3]+" PT</span></button>"}else{if(content[4]===null){ques+='<button style="border-radius: 12px;"class="btn-large col s6 m4 l3" id="'+content[0]+'" onclick="getQuestion(this)"><div style="min-height:30%;font-size: 14px">'+content[2]+'</div><span style="font-size: 12px;">'+content[3]+" PT</span></button>"}else{ques+=""}}}});if(ques!=""){ques+="<br><br></div>"}else{ques='<h2 class="center">No Questions, Please Contact The Administrator.</h2>'}$(".questions").html(ques+"<br><br><br><br><br><br>")},error:function(data){debugLog(data)}});$("#bques").show();return false}function closeModal(){$("#modal").modal("close");return false}$("#ques_con").on("click","#destroyDocker",function(){var tmp=this;debugLog(this);$.ajax({type:"POST",url:"ajax.php?m=getDestroyDocker",data:{"token":token},dataType:"json",success:function(data){debugLog(data);if(errorCheck(data)){return false}Materialize.toast("销毁成功",4000,"rounded");$("#modal").modal("close")},error:function(data){debugLog(data)}});return false});$("#ques_con").on("click","#dockerButton",function(){var tmp=this;debugLog(this);tmp.text="Docker 下发中...";$.ajax({type:"POST",url:"ajax.php?m=getDocker",data:{"token":token},dataType:"json",success:function(data){debugLog(data);if(errorCheck(data)){tmp.text="下发Docker";$("#modal").modal("close");return false}Materialize.toast("环境下发成功，请等待5-15秒中重新进入题目查看地址 , 环境有效期："+data[0][1]+"s",4000,"rounded");$("#modal").modal("close");tmp.text="下发成功"},error:function(data){debugLog(data)}});return false});$(document).ready(function(){$(".modal").modal({complete:function(){$("#ques_solve").html("");$("#ques_score").html("");$("#ques_tit").html("");$("#ques_con").html("");$("#solves").html("");$('[name="flag"]').val("");$("ul.tabs").tabs("select_tab","mod1")}});getQuestions();$("form").submit(function(){$.ajax({type:"POST",url:"ajax.php?m=flagSubmit",data:{"flag":$('[name="flag"]').prop("value"),"token":token},dataType:"json",success:function(data){debugLog(data);$("#modal").modal("close");Materialize.toast(data[0][1],4000,"rounded");if(data[0][0]=="0"){return false}if(data[0][0]=="-1"){setTimeout(function(){window.location.href="./account.html"},3000)}if(data[0][0]=="1"){$('[id="'+quesid+'"]').addClass("green lighten-2");getQuestions()}},error:function(data){debugLog(data)}});return false})});